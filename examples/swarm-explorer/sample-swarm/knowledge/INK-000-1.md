---
id: "K-001"
source_story: "INK-000"
source_repo: "ink-panels"
created: "2026-02-17T18:00:00Z"
author: "frontend-dev"
dimension: "qualia"
scope: "repo"
hoistable: true
confidence: "high"
tags: ["react", "state", "timing"]
domain: "frontend"
title: "React 19 setState updaters are not synchronous"
description: "setState(fn) updater functions are NOT guaranteed to run synchronously in React 19. Side effects inside setState updaters may not execute when expected."
context: "When using useState with updater functions that need to return values or trigger side effects synchronously"
recommendation: "Mirror state with useRef for synchronous reads. Call setStack(newValue) with the ref's current value instead of relying on the updater."
---

# K-001: React 19 setState timing

Discovered during PanelStack development when navigation state was inconsistent.
The fix was to use `useRef` alongside `useState` for synchronous access.
